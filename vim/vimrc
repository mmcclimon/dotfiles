" new and improved .vimrc

set nocompatible

" Plugins {{{
" -----------
filetype off                        " required!

set rtp+=~/.vim/bundle/Vundle.vim
call vundle#begin()

Plugin 'gmarik/Vundle.vim'          " vundle must manage itself
Plugin 'chriskempson/base16-vim'
Plugin 'bufkill.vim'
Plugin 'kien/ctrlp.vim'
Plugin 'ledger/vim-ledger'
Plugin 'Lokaltog/vim-easymotion'
Plugin 'pangloss/vim-javascript'
Plugin 'vim-perl/vim-perl'
Plugin 'tpope/vim-repeat'
Plugin 'tpope/vim-rsi'
Plugin 'tpope/vim-surround'

call vundle#end()
filetype plugin indent on           " required!
" }}}

" Text Editing {{{
" ----------------
set backspace=indent,eol,start  " backspace works over everything
set autoindent                  " use previous line's indent
set smartindent                 " indent braces automatically
set expandtab                   " what am i, an animal? use spaces
set tabstop=4                   " four spaces
set shiftwidth=4
set textwidth=78                " 78 works nicely for wrapping
" }}}

" UI {{{
" ------
set history=50                  " keep 50 lines of command line history
set ruler                       " show the cursor position all the time
set showcmd                     " display incomplete commands
set incsearch                   " do incremental searching
set ignorecase                  " ignore case, but...
set smartcase                   " only if pattern is all lowercase
set laststatus=2                " always show status line
set number                      " always show line nums
set hidden                      " allow hidden buffers
set wildmenu                    " better tab completion
set splitright                  " vertical splits open to right
set mouse=a                     " turn on mouse
set wildmode=longest:full,longest
set wildignore+=.git,.svn,local,build,vendor,.sass-cache
set list listchars=tab:▸\ ,trail:·,extends:❯,precedes:❮



function! SyntaxItem()
    return synIDattr(synID(line("."),col("."),1),"name")
endfunction

set statusline=%<%f\ %h%m%r\ %{SyntaxItem()}%=%-14.(%l,%c%V%)\ %P

" Folding
set foldlevelstart=99           " all folds start open
augroup folding
    au!
    au BufReadPre * setlocal foldmethod=indent
    au BufWinEnter * if &fdm == 'indent' | setlocal foldmethod=manual | endif
augroup END

" Colors
set background=dark
colorscheme base16-default-dark

if &t_Co > 2 || has("gui_running")
  syntax on
  set hlsearch
endif

" be annoying about extra whitespace
augroup trailing
    au!
    au InsertEnter * match ExtraWhitespace /\s\+\%#\@<!$/
    au InsertLeave * match ExtraWhitespace /\s\+$/
augroup END
highlight ExtraWhitespace ctermbg=red guibg=red

" }}}

" Mappings ----------------------------------------------------{{{
let mapleader=","
let maplocalleader = '\\'
nnoremap <silent> <leader>s :nohls<CR>
nnoremap q: <Nop>

" better window motion
nnoremap <C-h> <C-w>h
nnoremap <C-j> <C-w>j
nnoremap <C-k> <C-w>k
nnoremap <C-l> <C-w>l

" switch colon and semicolon
nnoremap ; :
nnoremap : ;
inoremap <c-c> <esc>
" Uppercase last word in insert mode (stolen from Steve Losh).
inoremap <C-u> <esc>mzgUiw`za
" }}}

" Misc. settings {{{
" ------------------

" backups
set backup                      " keep a backup file
set backupdir=~/.vim/backup     " might as well keep them here
set autowrite                   " save things automatically

let g:tex_flavor = "latex"      " plaintex is no good

" fix crontab bug
au BufEnter /private/tmp/crontab.* setl backupcopy=yes


" associate unknown files
augroup local_ftdetect
    au!
    au BufNewFile,BufRead *.adoc set filetype=asciidoc      " asciidoc
    au BufNewFile,BufRead *.thtml set filetype=php          " php templates
augroup END

" }}}

" Imports {{{
" -----------
so ~/.vim/functions.vim   " load custom functions
so ~/.vim/plugins.vim     " load plugin settings
so ~/.vim/abbrevs.vim     " I can't type
" }}}

" vim:fdm=marker
" vim:set filetype=vim
